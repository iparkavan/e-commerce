"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("src/middleware",{

/***/ "(middleware)/./src/middleware.ts":
/*!***************************!*\
  !*** ./src/middleware.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   middleware: () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(middleware)/./node_modules/next/dist/esm/server/web/exports/next-response.js\");\n/* harmony import */ var js_cookie__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! js-cookie */ \"(middleware)/./node_modules/js-cookie/dist/js.cookie.mjs\");\n\n\n// This function can be marked `async` if using `await` inside\n// const protectedRoutes = ['/']\n// const publicRoutes = ['/login', '/signup']\nasync function middleware(request) {\n    const authToken = request.cookies.get(\"token\")?.value;\n    const userId = request.cookies.get(\"userId\")?.value;\n    // console.log(\"iserID\",userId)\n    const afterLoggedIn = request.nextUrl.pathname === \"/login\" || request.nextUrl.pathname === \"/signup\";\n    if (afterLoggedIn) {\n        if (authToken) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].redirect(new URL(\"/\", request.url));\n        }\n    } else {\n        if (!authToken) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].redirect(new URL(\"/login\", request.url));\n        } else {\n            // verify\n            const res = await fetch(\"http://localhost:4000/api/auth/verify-token\", {\n                method: \"GET\",\n                headers: {\n                    Authorization: \"Bearer \" + authToken\n                }\n            });\n            const data = await res.json();\n            // console.log(\"middale\", data.userId)\n            if (data.userId !== userId) {\n                console.log(request.cookies.get(\"token\"), js_cookie__WEBPACK_IMPORTED_MODULE_1__[\"default\"].get(\"userId\"));\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].redirect(new URL(\"/login\", request.url));\n            }\n        }\n    }\n// const path = request.nextUrl.pathname\n// const isProtectedRoute = protectedRoutes.includes(path)\n// const isPublicRoute = publicRoutes.includes(path)\n// const data = useValidateUser(token.value)\n// console.log(\"token verification\",data)\n// if (!token) {\n//    return NextResponse.redirect(new URL('/login', request.url))\n// }\n// if ( request.nextUrl.pathname === \"/\") {\n//   return NextResponse.redirect(new URL('/', request.url))\n// }\n// if ( request.nextUrl.pathname === \"/products\") {\n//   return NextResponse.redirect(new URL('/products', request.url))\n// }\n// if ( request.nextUrl.pathname === \"/shop\") {\n//   return NextResponse.redirect(new URL('/shop', request.url))\n// }\n}\n// See \"Matching Paths\" below to learn more\nconst config = {\n    matcher: [\n        \"/login\",\n        \"/signup\",\n        \"/\",\n        \"/products\",\n        \"/products/:path*\",\n        \"/shop\"\n    ]\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKG1pZGRsZXdhcmUpLy4vc3JjL21pZGRsZXdhcmUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUEwQztBQUlWO0FBR2hDLDhEQUE4RDtBQUU5RCxnQ0FBZ0M7QUFDaEMsNkNBQTZDO0FBRXRDLGVBQWVFLFdBQVlDLE9BQW9CO0lBR3BELE1BQU1DLFlBQVlELFFBQVFFLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLFVBQVVDO0lBQ2hELE1BQU1DLFNBQVNMLFFBQVFFLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLFdBQVdDO0lBQzlDLCtCQUErQjtJQUUvQixNQUFNRSxnQkFBZ0JOLFFBQVFPLE9BQU8sQ0FBQ0MsUUFBUSxLQUFLLFlBQVlSLFFBQVFPLE9BQU8sQ0FBQ0MsUUFBUSxLQUFLO0lBRTVGLElBQUlGLGVBQWU7UUFDakIsSUFBSUwsV0FBVztZQUNiLE9BQU9KLGtGQUFZQSxDQUFDWSxRQUFRLENBQUMsSUFBSUMsSUFBSSxLQUFLVixRQUFRVyxHQUFHO1FBQ3ZEO0lBQ0YsT0FBTztRQUNMLElBQUksQ0FBQ1YsV0FBVztZQUNkLE9BQU9KLGtGQUFZQSxDQUFDWSxRQUFRLENBQUMsSUFBSUMsSUFBSSxVQUFVVixRQUFRVyxHQUFHO1FBQzVELE9BQU87WUFDTCxTQUFTO1lBQ1QsTUFBTUMsTUFBTSxNQUFNQyxNQUFNLCtDQUErQztnQkFDckVDLFFBQVE7Z0JBQ1JDLFNBQVM7b0JBQ1BDLGVBQWUsWUFBWWY7Z0JBQzdCO1lBQ0Y7WUFDQSxNQUFNZ0IsT0FBTyxNQUFNTCxJQUFJTSxJQUFJO1lBQzNCLHNDQUFzQztZQUN0QyxJQUFJRCxLQUFLWixNQUFNLEtBQUtBLFFBQVM7Z0JBQzNCYyxRQUFRQyxHQUFHLENBQUNwQixRQUFRRSxPQUFPLENBQUNDLEdBQUcsQ0FBQyxVQUNoQ0wsaURBQU9BLENBQUNLLEdBQUcsQ0FBQztnQkFDWixPQUFPTixrRkFBWUEsQ0FBQ1ksUUFBUSxDQUFDLElBQUlDLElBQUksVUFBVVYsUUFBUVcsR0FBRztZQUM1RDtRQUNGO0lBQ0Y7QUFHQSx3Q0FBd0M7QUFDeEMsMERBQTBEO0FBQzFELG9EQUFvRDtBQUNwRCw0Q0FBNEM7QUFFNUMseUNBQXlDO0FBR3pDLGdCQUFnQjtBQUNoQixrRUFBa0U7QUFDbEUsSUFBSTtBQUVKLDJDQUEyQztBQUMzQyw0REFBNEQ7QUFDNUQsSUFBSTtBQUVKLG1EQUFtRDtBQUNuRCxvRUFBb0U7QUFDcEUsSUFBSTtBQUVKLCtDQUErQztBQUMvQyxnRUFBZ0U7QUFDaEUsSUFBSTtBQUNOO0FBRUEsMkNBQTJDO0FBQ3BDLE1BQU1VLFNBQVM7SUFDcEJDLFNBQVM7UUFDUDtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7S0FDRDtBQUNILEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vc3JjL21pZGRsZXdhcmUudHM/ZDE5OSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcclxuaW1wb3J0IHsgTmV4dFJlcXVlc3QgfSBmcm9tICduZXh0L3NlcnZlcidcclxuaW1wb3J0IHsgdXNlVmVyaWZ5VG9rZW4gfSBmcm9tICcuL2hvb2tzL2F1dGgtaG9va3MnXHJcbmltcG9ydCBheGlvcyBmcm9tICdheGlvcydcclxuaW1wb3J0IENvb2tpZXMgZnJvbSBcImpzLWNvb2tpZVwiO1xyXG5cclxuIFxyXG4vLyBUaGlzIGZ1bmN0aW9uIGNhbiBiZSBtYXJrZWQgYGFzeW5jYCBpZiB1c2luZyBgYXdhaXRgIGluc2lkZVxyXG5cclxuLy8gY29uc3QgcHJvdGVjdGVkUm91dGVzID0gWycvJ11cclxuLy8gY29uc3QgcHVibGljUm91dGVzID0gWycvbG9naW4nLCAnL3NpZ251cCddXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbWlkZGxld2FyZSAocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcclxuXHJcbiAgXHJcbiAgY29uc3QgYXV0aFRva2VuID0gcmVxdWVzdC5jb29raWVzLmdldChcInRva2VuXCIpPy52YWx1ZVxyXG4gIGNvbnN0IHVzZXJJZCA9IHJlcXVlc3QuY29va2llcy5nZXQoXCJ1c2VySWRcIik/LnZhbHVlXHJcbiAgLy8gY29uc29sZS5sb2coXCJpc2VySURcIix1c2VySWQpXHJcblxyXG4gIGNvbnN0IGFmdGVyTG9nZ2VkSW4gPSByZXF1ZXN0Lm5leHRVcmwucGF0aG5hbWUgPT09IFwiL2xvZ2luXCIgfHwgcmVxdWVzdC5uZXh0VXJsLnBhdGhuYW1lID09PSBcIi9zaWdudXBcIiBcclxuXHJcbiAgaWYgKGFmdGVyTG9nZ2VkSW4pIHtcclxuICAgIGlmIChhdXRoVG9rZW4pIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChuZXcgVVJMKCcvJywgcmVxdWVzdC51cmwpKVxyXG4gICAgfVxyXG4gIH0gZWxzZSB7XHJcbiAgICBpZiAoIWF1dGhUb2tlbikge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KG5ldyBVUkwoJy9sb2dpbicsIHJlcXVlc3QudXJsKSlcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIHZlcmlmeVxyXG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChcImh0dHA6Ly9sb2NhbGhvc3Q6NDAwMC9hcGkvYXV0aC92ZXJpZnktdG9rZW5cIiwge1xyXG4gICAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICBBdXRob3JpemF0aW9uOiBcIkJlYXJlciBcIiArIGF1dGhUb2tlblxyXG4gICAgICAgIH0gXHJcbiAgICAgIH0pXHJcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXMuanNvbigpXHJcbiAgICAgIC8vIGNvbnNvbGUubG9nKFwibWlkZGFsZVwiLCBkYXRhLnVzZXJJZClcclxuICAgICAgaWYgKGRhdGEudXNlcklkICE9PSB1c2VySWQgKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2cocmVxdWVzdC5jb29raWVzLmdldChcInRva2VuXCIpLFxyXG4gICAgICAgIENvb2tpZXMuZ2V0KFwidXNlcklkXCIpKVxyXG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTCgnL2xvZ2luJywgcmVxdWVzdC51cmwpKVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBcclxuICAvLyBjb25zdCBwYXRoID0gcmVxdWVzdC5uZXh0VXJsLnBhdGhuYW1lXHJcbiAgLy8gY29uc3QgaXNQcm90ZWN0ZWRSb3V0ZSA9IHByb3RlY3RlZFJvdXRlcy5pbmNsdWRlcyhwYXRoKVxyXG4gIC8vIGNvbnN0IGlzUHVibGljUm91dGUgPSBwdWJsaWNSb3V0ZXMuaW5jbHVkZXMocGF0aClcclxuICAvLyBjb25zdCBkYXRhID0gdXNlVmFsaWRhdGVVc2VyKHRva2VuLnZhbHVlKVxyXG5cclxuICAvLyBjb25zb2xlLmxvZyhcInRva2VuIHZlcmlmaWNhdGlvblwiLGRhdGEpXHJcblxyXG5cclxuICAvLyBpZiAoIXRva2VuKSB7XHJcbiAgLy8gICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChuZXcgVVJMKCcvbG9naW4nLCByZXF1ZXN0LnVybCkpXHJcbiAgLy8gfVxyXG5cclxuICAvLyBpZiAoIHJlcXVlc3QubmV4dFVybC5wYXRobmFtZSA9PT0gXCIvXCIpIHtcclxuICAvLyAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTCgnLycsIHJlcXVlc3QudXJsKSlcclxuICAvLyB9XHJcblxyXG4gIC8vIGlmICggcmVxdWVzdC5uZXh0VXJsLnBhdGhuYW1lID09PSBcIi9wcm9kdWN0c1wiKSB7XHJcbiAgLy8gICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KG5ldyBVUkwoJy9wcm9kdWN0cycsIHJlcXVlc3QudXJsKSlcclxuICAvLyB9XHJcblxyXG4gIC8vIGlmICggcmVxdWVzdC5uZXh0VXJsLnBhdGhuYW1lID09PSBcIi9zaG9wXCIpIHtcclxuICAvLyAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTCgnL3Nob3AnLCByZXF1ZXN0LnVybCkpXHJcbiAgLy8gfVxyXG59XHJcbiBcclxuLy8gU2VlIFwiTWF0Y2hpbmcgUGF0aHNcIiBiZWxvdyB0byBsZWFybiBtb3JlXHJcbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XHJcbiAgbWF0Y2hlcjogW1xyXG4gICAgXCIvbG9naW5cIiwgXHJcbiAgICBcIi9zaWdudXBcIixcclxuICAgIFwiL1wiLCBcclxuICAgIFwiL3Byb2R1Y3RzXCIsIFxyXG4gICAgXCIvcHJvZHVjdHMvOnBhdGgqXCIsIFxyXG4gICAgXCIvc2hvcFwiLCBcclxuICBdXHJcbn0iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiQ29va2llcyIsIm1pZGRsZXdhcmUiLCJyZXF1ZXN0IiwiYXV0aFRva2VuIiwiY29va2llcyIsImdldCIsInZhbHVlIiwidXNlcklkIiwiYWZ0ZXJMb2dnZWRJbiIsIm5leHRVcmwiLCJwYXRobmFtZSIsInJlZGlyZWN0IiwiVVJMIiwidXJsIiwicmVzIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwiQXV0aG9yaXphdGlvbiIsImRhdGEiLCJqc29uIiwiY29uc29sZSIsImxvZyIsImNvbmZpZyIsIm1hdGNoZXIiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(middleware)/./src/middleware.ts\n");

/***/ })

});