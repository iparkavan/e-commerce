"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("src/middleware",{

/***/ "(middleware)/./src/middleware.ts":
/*!***************************!*\
  !*** ./src/middleware.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   middleware: () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(middleware)/./node_modules/next/dist/esm/server/web/exports/next-response.js\");\n\n// This function can be marked `async` if using `await` inside\n// const protectedRoutes = ['/']\n// const publicRoutes = ['/login', '/signup']\nasync function middleware(request) {\n    const authToken = request.cookies.get(\"token\")?.value;\n    const userId = request.cookies.get(\"userId\")?.value;\n    // console.log(\"iserID\",userId)\n    const afterLoggedIn = request.nextUrl.pathname === \"/login\" || request.nextUrl.pathname === \"/signup\";\n    if (afterLoggedIn) {\n        if (authToken) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].redirect(new URL(\"/\", request.url));\n        }\n    } else {\n        if (!authToken) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].redirect(new URL(\"/login\", request.url));\n        } else {\n            // verify\n            const res = await fetch(\"http://localhost:4000/api/auth/verify-token\", {\n                method: \"GET\",\n                headers: {\n                    Authorization: \"Bearer \" + authToken\n                }\n            });\n            const data = await res.json();\n            // console.log(\"middale\", data.userId)\n            if (data.userId !== userId) {\n                // console.log(request.cookies.delete(\"token\"),\n                // request.cookies.delete(\"userId\"))\n                const deleteTokenId = request.cookies.delete(\"token\") && request.cookies.delete(\"userId\");\n                if (deleteTokenId) {}\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].redirect(new URL(\"/login\", request.url));\n            }\n        }\n    }\n// const path = request.nextUrl.pathname\n// const isProtectedRoute = protectedRoutes.includes(path)\n// const isPublicRoute = publicRoutes.includes(path)\n// const data = useValidateUser(token.value)\n// console.log(\"token verification\",data)\n// if (!token) {\n//    return NextResponse.redirect(new URL('/login', request.url))\n// }\n// if ( request.nextUrl.pathname === \"/\") {\n//   return NextResponse.redirect(new URL('/', request.url))\n// }\n// if ( request.nextUrl.pathname === \"/products\") {\n//   return NextResponse.redirect(new URL('/products', request.url))\n// }\n// if ( request.nextUrl.pathname === \"/shop\") {\n//   return NextResponse.redirect(new URL('/shop', request.url))\n// }\n}\n// See \"Matching Paths\" below to learn more\nconst config = {\n    matcher: [\n        \"/login\",\n        \"/signup\",\n        \"/\",\n        \"/products\",\n        \"/products/:path*\",\n        \"/shop\"\n    ]\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKG1pZGRsZXdhcmUpLy4vc3JjL21pZGRsZXdhcmUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQTBDO0FBTzFDLDhEQUE4RDtBQUU5RCxnQ0FBZ0M7QUFDaEMsNkNBQTZDO0FBRXRDLGVBQWVDLFdBQVlDLE9BQW9CO0lBR3BELE1BQU1DLFlBQVlELFFBQVFFLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLFVBQVVDO0lBQ2hELE1BQU1DLFNBQVNMLFFBQVFFLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLFdBQVdDO0lBQzlDLCtCQUErQjtJQUUvQixNQUFNRSxnQkFBZ0JOLFFBQVFPLE9BQU8sQ0FBQ0MsUUFBUSxLQUFLLFlBQVlSLFFBQVFPLE9BQU8sQ0FBQ0MsUUFBUSxLQUFLO0lBRTVGLElBQUlGLGVBQWU7UUFDakIsSUFBSUwsV0FBVztZQUNiLE9BQU9ILGtGQUFZQSxDQUFDVyxRQUFRLENBQUMsSUFBSUMsSUFBSSxLQUFLVixRQUFRVyxHQUFHO1FBQ3ZEO0lBQ0YsT0FBTztRQUNMLElBQUksQ0FBQ1YsV0FBVztZQUNkLE9BQU9ILGtGQUFZQSxDQUFDVyxRQUFRLENBQUMsSUFBSUMsSUFBSSxVQUFVVixRQUFRVyxHQUFHO1FBQzVELE9BQU87WUFDTCxTQUFTO1lBQ1QsTUFBTUMsTUFBTSxNQUFNQyxNQUFNLCtDQUErQztnQkFDckVDLFFBQVE7Z0JBQ1JDLFNBQVM7b0JBQ1BDLGVBQWUsWUFBWWY7Z0JBQzdCO1lBQ0Y7WUFDQSxNQUFNZ0IsT0FBTyxNQUFNTCxJQUFJTSxJQUFJO1lBQzNCLHNDQUFzQztZQUN0QyxJQUFJRCxLQUFLWixNQUFNLEtBQUtBLFFBQVM7Z0JBQzNCLCtDQUErQztnQkFDL0Msb0NBQW9DO2dCQUNwQyxNQUFNYyxnQkFBZ0JuQixRQUFRRSxPQUFPLENBQUNrQixNQUFNLENBQUMsWUFBWXBCLFFBQVFFLE9BQU8sQ0FBQ2tCLE1BQU0sQ0FBQztnQkFDaEYsSUFBSUQsZUFBZSxDQUVuQjtnQkFDQSxPQUFPckIsa0ZBQVlBLENBQUNXLFFBQVEsQ0FBQyxJQUFJQyxJQUFJLFVBQVVWLFFBQVFXLEdBQUc7WUFDNUQ7UUFDRjtJQUNGO0FBR0Esd0NBQXdDO0FBQ3hDLDBEQUEwRDtBQUMxRCxvREFBb0Q7QUFDcEQsNENBQTRDO0FBRTVDLHlDQUF5QztBQUd6QyxnQkFBZ0I7QUFDaEIsa0VBQWtFO0FBQ2xFLElBQUk7QUFFSiwyQ0FBMkM7QUFDM0MsNERBQTREO0FBQzVELElBQUk7QUFFSixtREFBbUQ7QUFDbkQsb0VBQW9FO0FBQ3BFLElBQUk7QUFFSiwrQ0FBK0M7QUFDL0MsZ0VBQWdFO0FBQ2hFLElBQUk7QUFDTjtBQUVBLDJDQUEyQztBQUNwQyxNQUFNVSxTQUFTO0lBQ3BCQyxTQUFTO1FBQ1A7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO0tBQ0Q7QUFDSCxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL3NyYy9taWRkbGV3YXJlLnRzP2QxOTkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInXHJcbmltcG9ydCB7IE5leHRSZXF1ZXN0IH0gZnJvbSAnbmV4dC9zZXJ2ZXInXHJcbmltcG9ydCB7IHVzZVZlcmlmeVRva2VuIH0gZnJvbSAnLi9ob29rcy9hdXRoLWhvb2tzJ1xyXG5pbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnXHJcbmltcG9ydCBDb29raWVzIGZyb20gXCJqcy1jb29raWVcIjtcclxuXHJcbiBcclxuLy8gVGhpcyBmdW5jdGlvbiBjYW4gYmUgbWFya2VkIGBhc3luY2AgaWYgdXNpbmcgYGF3YWl0YCBpbnNpZGVcclxuXHJcbi8vIGNvbnN0IHByb3RlY3RlZFJvdXRlcyA9IFsnLyddXHJcbi8vIGNvbnN0IHB1YmxpY1JvdXRlcyA9IFsnL2xvZ2luJywgJy9zaWdudXAnXVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG1pZGRsZXdhcmUgKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XHJcblxyXG4gIFxyXG4gIGNvbnN0IGF1dGhUb2tlbiA9IHJlcXVlc3QuY29va2llcy5nZXQoXCJ0b2tlblwiKT8udmFsdWVcclxuICBjb25zdCB1c2VySWQgPSByZXF1ZXN0LmNvb2tpZXMuZ2V0KFwidXNlcklkXCIpPy52YWx1ZVxyXG4gIC8vIGNvbnNvbGUubG9nKFwiaXNlcklEXCIsdXNlcklkKVxyXG5cclxuICBjb25zdCBhZnRlckxvZ2dlZEluID0gcmVxdWVzdC5uZXh0VXJsLnBhdGhuYW1lID09PSBcIi9sb2dpblwiIHx8IHJlcXVlc3QubmV4dFVybC5wYXRobmFtZSA9PT0gXCIvc2lnbnVwXCIgXHJcblxyXG4gIGlmIChhZnRlckxvZ2dlZEluKSB7XHJcbiAgICBpZiAoYXV0aFRva2VuKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTCgnLycsIHJlcXVlc3QudXJsKSlcclxuICAgIH1cclxuICB9IGVsc2Uge1xyXG4gICAgaWYgKCFhdXRoVG9rZW4pIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChuZXcgVVJMKCcvbG9naW4nLCByZXF1ZXN0LnVybCkpXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyB2ZXJpZnlcclxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goXCJodHRwOi8vbG9jYWxob3N0OjQwMDAvYXBpL2F1dGgvdmVyaWZ5LXRva2VuXCIsIHtcclxuICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgQXV0aG9yaXphdGlvbjogXCJCZWFyZXIgXCIgKyBhdXRoVG9rZW5cclxuICAgICAgICB9IFxyXG4gICAgICB9KVxyXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzLmpzb24oKVxyXG4gICAgICAvLyBjb25zb2xlLmxvZyhcIm1pZGRhbGVcIiwgZGF0YS51c2VySWQpXHJcbiAgICAgIGlmIChkYXRhLnVzZXJJZCAhPT0gdXNlcklkICkge1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHJlcXVlc3QuY29va2llcy5kZWxldGUoXCJ0b2tlblwiKSxcclxuICAgICAgICAvLyByZXF1ZXN0LmNvb2tpZXMuZGVsZXRlKFwidXNlcklkXCIpKVxyXG4gICAgICAgIGNvbnN0IGRlbGV0ZVRva2VuSWQgPSByZXF1ZXN0LmNvb2tpZXMuZGVsZXRlKFwidG9rZW5cIikgJiYgcmVxdWVzdC5jb29raWVzLmRlbGV0ZShcInVzZXJJZFwiKVxyXG4gICAgICAgIGlmIChkZWxldGVUb2tlbklkKSB7XHJcbiAgICAgICAgICBcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChuZXcgVVJMKCcvbG9naW4nLCByZXF1ZXN0LnVybCkpXHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIFxyXG4gIC8vIGNvbnN0IHBhdGggPSByZXF1ZXN0Lm5leHRVcmwucGF0aG5hbWVcclxuICAvLyBjb25zdCBpc1Byb3RlY3RlZFJvdXRlID0gcHJvdGVjdGVkUm91dGVzLmluY2x1ZGVzKHBhdGgpXHJcbiAgLy8gY29uc3QgaXNQdWJsaWNSb3V0ZSA9IHB1YmxpY1JvdXRlcy5pbmNsdWRlcyhwYXRoKVxyXG4gIC8vIGNvbnN0IGRhdGEgPSB1c2VWYWxpZGF0ZVVzZXIodG9rZW4udmFsdWUpXHJcblxyXG4gIC8vIGNvbnNvbGUubG9nKFwidG9rZW4gdmVyaWZpY2F0aW9uXCIsZGF0YSlcclxuXHJcblxyXG4gIC8vIGlmICghdG9rZW4pIHtcclxuICAvLyAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KG5ldyBVUkwoJy9sb2dpbicsIHJlcXVlc3QudXJsKSlcclxuICAvLyB9XHJcblxyXG4gIC8vIGlmICggcmVxdWVzdC5uZXh0VXJsLnBhdGhuYW1lID09PSBcIi9cIikge1xyXG4gIC8vICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChuZXcgVVJMKCcvJywgcmVxdWVzdC51cmwpKVxyXG4gIC8vIH1cclxuXHJcbiAgLy8gaWYgKCByZXF1ZXN0Lm5leHRVcmwucGF0aG5hbWUgPT09IFwiL3Byb2R1Y3RzXCIpIHtcclxuICAvLyAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTCgnL3Byb2R1Y3RzJywgcmVxdWVzdC51cmwpKVxyXG4gIC8vIH1cclxuXHJcbiAgLy8gaWYgKCByZXF1ZXN0Lm5leHRVcmwucGF0aG5hbWUgPT09IFwiL3Nob3BcIikge1xyXG4gIC8vICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChuZXcgVVJMKCcvc2hvcCcsIHJlcXVlc3QudXJsKSlcclxuICAvLyB9XHJcbn1cclxuIFxyXG4vLyBTZWUgXCJNYXRjaGluZyBQYXRoc1wiIGJlbG93IHRvIGxlYXJuIG1vcmVcclxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcclxuICBtYXRjaGVyOiBbXHJcbiAgICBcIi9sb2dpblwiLCBcclxuICAgIFwiL3NpZ251cFwiLFxyXG4gICAgXCIvXCIsIFxyXG4gICAgXCIvcHJvZHVjdHNcIiwgXHJcbiAgICBcIi9wcm9kdWN0cy86cGF0aCpcIiwgXHJcbiAgICBcIi9zaG9wXCIsIFxyXG4gIF1cclxufSJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJtaWRkbGV3YXJlIiwicmVxdWVzdCIsImF1dGhUb2tlbiIsImNvb2tpZXMiLCJnZXQiLCJ2YWx1ZSIsInVzZXJJZCIsImFmdGVyTG9nZ2VkSW4iLCJuZXh0VXJsIiwicGF0aG5hbWUiLCJyZWRpcmVjdCIsIlVSTCIsInVybCIsInJlcyIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsIkF1dGhvcml6YXRpb24iLCJkYXRhIiwianNvbiIsImRlbGV0ZVRva2VuSWQiLCJkZWxldGUiLCJjb25maWciLCJtYXRjaGVyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(middleware)/./src/middleware.ts\n");

/***/ })

});